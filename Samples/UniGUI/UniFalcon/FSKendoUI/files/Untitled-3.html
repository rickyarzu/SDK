<div id="fs_canOAE" style="position:absolute; width:100%; height:100%; ">
</div>
<script>
    const listProducts = [{
        name: "produto 1",
        qntd: 5,
        valor: 50.55
    }, {
        name: "produto 2",
        qntd: 2,
        valor: 26.2
    }, {
        name: "produto 2",
        qntd: 3,
        valor: 22.1
    }, {
        name: "produto 5",
        qntd: 3,
        valor: 22.0
    }, {
        name: "produto 6",
        qntd: 5,
        valor: 25.65
    },];

    var fs_chartOAE = Highcharts.chart("fs_canOAE", {
        chart: {
            type: "bar",
            marginTop: 80,
            height: listProducts.length * 55 + 80
        },
        title: {
            text: "10 produtos mais vendidos",
            align: "left"
        },
        xAxis: {
            categories: listProducts.map((obj) => obj.name + ` (${obj.qntd})`),
            labels: {
                x: 0,
                align: "left",
                reserveSpace: false,
                y: -18
            },
            gridLineWidth: 0.0,
            lineWidth: 0
        },
        yAxis: [{
            title: {
                enabled: true,
                align: "low",
                text: "<p>Quant.:" + getNumberItens(listProducts) + "</p>",
                style: {
                    color: "#656565",
                    fontSize: "0.9em"
                },
                useHTML: true
            },
            labels: {
                enabled: false
            },
            gridLineWidth: 0,
            endOnTick: false,
            min: 0,
            max: 100,
            lineWidth: 3,
            lineColor: "orange"
        }, {
            title: {
                enabled: true,
                align: "high",
                text: "<p style="
		margin - top: - 35 px;
        ">Total: " + valueToMoney(getTotal(listProducts)) + "</p>",
        style: {
            color: "#656565",
            fontSize: "0.9em"
        },
        useHTML: true
    },
        labels: {
        enabled: false
    },
        gridLineWidth: 0,
        endOnTick: false,
        min: 0,
        max: 100,
        lineWidth: 3,
        lineColor: "none"
}],
    credits: {
        enabled: false
    },
    series: [{
        animation: false,
        enableMouseTracking: false,
        color: "lightgray",
        dataLabels: [{
            y: -20,
            align: "right",
            format: "{point.value} ({point.percent}%)",
            color: "#8D8D8D",
            style: {
                fontWeight: "300",
                textOutline: "none"
            }
        }],
        data: listProducts.map((obj) => {
            return {
                value: valueToMoney(obj.valor * obj.qntd),
                percent: getPercent(obj.valor, obj.qntd).toFixed(2),
                y: 100
            };
        })
    }, {
        enableMouseTracking: false,
        animation: false,
        dataLabels: [{
            enabled: false
        }],
        color: "orange",
        data: listProducts.map((obj) => getPercent(obj.valor, obj.qntd))
    }],
        legend: {
        enabled: false
    },
    plotOptions: {
        bar: {
            pointWidth: 14,
                shadow: false
        },
        series: {
            stacking: "overlap",
                groupPadding: 0,
                    borderWidth: 0,
                        dataLabels: {
                verticalAlign: "top",
                    align: "right",
                        inside: true,
                            enabled: true
            },
            label: {
                enabled: true
            }
        }
    }
});

    function getTotal(listProducts) {
        var initialValue = 0;
        const total = listProducts.reduce((total, currentValue) => total + currentValue.qntd * currentValue.valor, initialValue);
        return total;
    }

    function getNumberItens(listProducts) {
        var initialValue = 0;
        const totalItens = listProducts.reduce((total, currentValue) => total + currentValue.qntd, initialValue);
        return totalItens;
    }

    function getPercent(value, qntd) {
        return ((qntd * value) / getTotal(listProducts)) * 100;
    }

    function valueToMoney(value) {
        return value.toLocaleString("pt-BR", {
            style: "currency",
            currency: "BRL"
        });
    }

    function InitChart() {
        ajaxRequest(OAE, "fs_init_chart", []);
    }
    InitChart(); 
</script>