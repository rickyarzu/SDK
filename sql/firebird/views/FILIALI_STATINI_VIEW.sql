CREATE OR ALTER VIEW FILIALI_STATINI_VIEW(
    CHIAVE,
    DESCRIZIONE_SCHEDA,
    CLIENTE,
    NOME,
    PROVINCIA,
    CAP,
    INDIRIZZO,
    TELEFONO,
    NOTE,
    ORARIO_APERTURA_DAL1,
    ORARIO_APERTURA_DAL2,
    ORARIO_APERTURA_AL1,
    ORARIO_APERTURA_AL2,
    CHIUSURA,
    CELLULARE,
    EMAIL,
    ESCLUDI_DA_GENERAZIONE,
    SEDE,
    ID,
    REF_TELEFONO,
    REF_CELLULARE,
    COMUNE,
    FATTURA,
    DATA_INTERVENTO,
    GENERAZIONE_AUTOMATICA,
    TECNICO_INTERVENTO,
    SCANSIONE,
    REGISTRO,
    NOTE_PER_IL_TECNICO,
    SOSPESO,
    DA_ESPORTARE_SUL_WEB,
    RESPONSABILE,
    ESPORTATO_SU_MOBILE,
    NOTE_DAL_TECNICO,
    VERBALE_PROVA_DINAMICA,
    VERBALE_MANICHETTE,
    PREVENTIVO,
    IGNORA_EVIDENZIAZIONE,
    ANNULLATO_DA_TABLET,
    MOBILEWARN_NUOVA_ATTREZZATURA,
    MOBILEWARN_ORDINARIA_RITIRATA,
    MOBILEWARN_N_ORDIN_CONTROLLATA,
    MOBILEWARN_SMALTIMENTO,
    STATO_LAVORAZIONE,
    DATA_CHIUSURA_DA_SERVER,
    CHIUSURA_EXT,
    CHIUSURA_STATINO,
    MOBILEWARN_NON_ESEGUITI,
    PRESA_IN_CARICO,
    FORNITURA,
    ORDINARI,
    STRAORDINARI,
    INTERVENTI,
    NOME_TECNICO,
    APPUNTAMENTO_DATA,
    APPUNTAMENTO_ORA,
    STATO)
AS
SELECT S.chiave, C.descrizione_scheda,
       S.CLIENTE, F.NOME, F.PROVINCIA, F.CAP, F.INDIRIZZO, F.TELEFONO, F.NOTE, F.ORARIO_APERTURA_DAL1, F.ORARIO_APERTURA_DAL2,
       F.ORARIO_APERTURA_AL1, F.ORARIO_APERTURA_AL2, F.CHIUSURA, F.CELLULARE, F.EMAIL, F.ESCLUDI_DA_GENERAZIONE, F.SEDE, F.ID,
       F.REF_TELEFONO, F.REF_CELLULARE, F.COMUNE,
       S.FATTURA,
       S.DATA_INTERVENTO , S.GENERAZIONE_AUTOMATICA , S.TECNICO_INTERVENTO , S.SCANSIONE , S.REGISTRO , S.NOTE_PER_IL_TECNICO , S.SOSPESO,
       S.DA_ESPORTARE_SUL_WEB , S.RESPONSABILE , S.ESPORTATO_SU_MOBILE , S.NOTE_DAL_TECNICO ,
       S.VERBALE_PROVA_DINAMICA , S.VERBALE_MANICHETTE , S.PREVENTIVO , S.IGNORA_EVIDENZIAZIONE,
       S.ANNULLATO_DA_TABLET , S.MOBILEWARN_NUOVA_ATTREZZATURA , S.MOBILEWARN_ORDINARIA_RITIRATA,
       S.MOBILEWARN_N_ORDIN_CONTROLLATA , S.MOBILEWARN_SMALTIMENTO , S.STATO_LAVORAZIONE , S.DATA_CHIUSURA_DA_SERVER , S.CHIUSURA_EXT,
       S.CHIUSURA_STATINO , S.MOBILEWARN_NON_ESEGUITI , S.PRESA_IN_CARICO , S.FORNITURA,
       V.ordinari, V.straordinari, V.interventi, T.descrizione as NOME_TECNICO, 
       S.APPUNTAMENTO_DATA, S.APPUNTAMENTO_ORA, S.STATO
FROM FILIALI_CLIENTI F 
JOIN CLIENTI C ON  F.CLIENTE = C.CHIAVE
JOIN STATINI S ON F.chiave = S.filiale
JOIN INTERVENTI_STRAORDINARI_VIEW V ON S.chiave = V.statino
JOIN TECNICI T ON T.chiave = S.responsabile
ORDER BY F.CAP,C.DESCRIZIONE_SCHEDA,F.SEDE DESC
;